{% extends "base.html" %}
{% load staticfiles %}

{% block headers %}
<link rel="stylesheet" href="{% static 'highlight/styles/default.css' %}">
{% endblock headers %}

{% block content %}

<!-- Main jumbotron for a primary marketing message or call to action -->
<div style="text-align:center">
  <div class="jumbotron">
    <div class="container">
      <h1>PV Free</h1>
      <p class="lead">A public API for PV modeling parameters.</p>
    </div><!-- /.container -->
  </div>
</div>

<div class="container">
  <h1>Usage</h1>
  <p>Browsing to <a target="_blank" href="http://pvfree.alwaysdata.net/api/pvinverter/?format=json"><code>http://pvfree.alwaysdata.net/api/pvinverter/?format=json</code></a> will display a <a target="_blank" href="http://json.org/">JSON</a> string with the first 20 records. The endpoint and querystring to obtain the next set "<a target="_blank" href="http://pvfree.alwaysdata.net/api/pvinverter/?format=json&limit=20&offset=20"><code>api/pvinverter/?limit=20&offset=20</code></a>" is contained in the "next" key of the string as are the endpoints for each inverter. <i>Note:</i> the querystring <code>?format=json</code> is only necessary when using the API url directly in a browser to display the response.</p>
  <h2><a target="_blank" href="https://django-tastypie.readthedocs.org/en/latest/">Tastypie</a></h2>
  <p>The API is generated by the Tastypie django extension. Add the following endpoints to the base URL, 
<a target="_blank" href="http://pvfree.alwaysdata.net/"><code>http://pvfree.alwaysdata.net/</code></a>:</p>
  <ul>
  <li>Get first 20 pvinverters.
  <pre>api/pvinverter/</pre>
  </li>
  <li>Get first pvinverter.
  <pre>api/pvinverter/1/</pre>
  </li>
  <li>Get pvinverter set containing #'s 2, 3, 5, and 10.
  <pre>api/pvinverter/set/2;3;5;10/</pre>
  </li>
  <li>Get 100 pvinverters starting from pvinverter # 500.
  <pre>api/pvinverter/?limit=100&amp;offset=500</pre>
  </li>
  <li>Get pvinverter database schema.
  <pre>api/pvinverter/schema/</pre>
  </li>
  </ul>
  <h2><a target="_blank" href="http://docs.python-requests.org/en/latest/">Python Requests</a></h2>
  <p><a targt="_blank" href="http://python.org">Python</a> has several libraries for interacting with URLs. The Requests package is available from <a target="_blank" href="https://pypi.python.org/pypi/requests">PyPI</a>.</p>
<pre><code class="language-python">&gt;&gt;&gt; import requests
&gt;&gt;&gt; response = requests.get('http://pvfree.alwaysdata.net/api/pvinverter/set/1;3;5/')
&gt;&gt;&gt; response
  &lt;Response [200]&gt;
&gt;&gt;&gt; response.status_code
  200
&gt;&gt;&gt; response.content
  {"objects": [{"C0": -2.48104842861e-05, "C1": -9.0149429405099999e-05, "C2": 0.00066889632690700005, "C3": -0.018880466688599998, "Idcmax": 10.0, "MPPT_hi": 50.0, "MPPT_low": 20.0, "Paco": 250.0, "Pdco": 259.52205054799998, "Pnt": 0.02, "Pso": 1.7716142241299999, "Sandia_ID": 1399, "Tamb_low": -40.0, "Tamb_max": 85.0, "Vaco": 208.0, "Vdcmax": 65.0, "Vdco": 40.242603174599999, "id": 1, "manufacturer": "ABB", "name": "MICRO-0.25-I-OUTD-US-208", "numberMPPTChannels": 1, "resource_uri": "/api/pvinverter/1/", "source": "CEC", "vintage": "2014-01-01", "weight": 1.6499999999999999}, ...]}
</code></pre>
  <h2><a target="_blank" href="http://curl.haxx.se/">cURL</a></h2>
  <p>Use <code>curl</code> from the command line or libcurl programmatically</p>
<pre><code class="language-bash">$ curl -H "Accept: application/json" http://pvfree.alwaysdata.net/api/pvinverter/
  {"meta": {"limit": 20, "next": "/api/pvinverter/?limit=20&amp;offset=20", "offset": 0, "previous": null, "total_count": 1742}, "objects": [{"C0": -2.48104842861e-05, "C1": -9.0149429405099999e-05, "C2": 0.00066889632690700005, "C3": -0.018880466688599998, "Idcmax": 10.0, "MPPT_hi": 50.0, "MPPT_low": 20.0, "Paco": 250.0, "Pdco": 259.52205054799998, "Pnt": 0.02, "Pso": 1.7716142241299999, "Sandia_ID": 1399, "Tamb_low": -40.0, "Tamb_max": 85.0, "Vaco": 208.0, "Vdcmax": 65.0, "Vdco": 40.242603174599999, "id": 1, "manufacturer": "ABB", "name": "MICRO-0.25-I-OUTD-US-208", "numberMPPTChannels": 1, "resource_uri": "/api/pvinverter/1/", "source": "CEC", "vintage": "2014-01-01", "weight": 1.6499999999999999}, ...]}
</code></pre>
  <h2><a target="_blank" href="http://oracle.com/java">Java</a></h2>
  <p>Use <a target="_blank" href="http://docs.oracle.com/javase/7/docs/api/java/net/package-summary.html"><code>java.net</code></a> package to connect and <a target="_blank" href="http://docs.oracle.com/javaee/7/api/javax/json/package-summary.html"><code>javax.json</code></a> to use the resource.</p>
<pre><code class="language-java">import java.net.*;
import java.io.*;
import javax.json.*;
...
URL pvfree = new URL("https://pvfree.alwaysdata.net/api/pvinverter/");  
URLConnection pvfreeConn = pvfree.openConnection();
pvfreeConn.addRequestProperty("Accept","application/json");
BufferedReader in = new BufferedReader(
  new InputStreamReader(pvfreeConn.getInputStream()));
JsonReader jsonReader = Json.createReader(in);
JsonObject array = jsonReader.readObject();
jsonReader.close();
</code></pre>
  <h1>Filters</h1>
  <p>The following fields can be <a target="_blank" 
href="https://django-tastypie.readthedocs.org/en/latest/resources.html?highlight=filtering#basic-filtering">filtered</a> using <a 
target="_blank" href="https://docs.djangoproject.com/en/1.6/ref/models/querysets/#field-lookups" >Django 
ORM</a>. Add the query strings to the API base URL, <a target="_blank" 
href="http://pvfree.alwaysdata.net/api/pvinverter/?format=json"><code>api/pvinverter</code></a>. <i>Note:</i> use encoded 
URI components for the following reserved query string characters: for <b>"&amp;"</b> 
use 
<b>"%26"</b>, for <b>"+"</b> use <b>"%2B"</b>, for <b>"?"</b> 
use <b>"%3F"</b> and for <b>"="</b> use <b>"%3D"</b>.</p>
  <ul>
  <li>field: <code>manufacturer</code>
    <ul>
    <li>filters: <code>iexact</code>, <code>istartswith</code>, <code>icontains</code>, <code>iregex</code>, <code>iendswith</code></li>
    <li>example: <a target="_blank"
href="http://pvfree.alwaysdata.net/api/pvinverter/?format=json&manufacturer__istartswith=general"><code>?manufacturer__istartswith=general</code></a></li>
    </ul>
  </li>
  <li>field: <code>name</code>
    <ul>
    <li>filters: <code>iexact</code>, <code>istartswith</code>, <code>icontains</code>, <code>iregex</code>, <code>iendswith</code></li>
    <li>example: <a target="_blank"
href="http://pvfree.alwaysdata.net/api/pvinverter/?format=json&name__iregex=^PVI[- ]"><code>?name__iregex=^PVI[- ]</code></a></li>
    </ul>
  </li>
  <li>field: <code>Vaco</code>
    <ul>
    <li>filters: <code>exact</code>, <code>lt</code>, <code>lte</code>, <code>gt</code>, <code>gte</code></li>
    <li>example: <a target="_blank"
href="http://pvfree.alwaysdata.net/api/pvinverter/?format=json&Vaco__gt=200&Vaco__lte=300"><code>?Vaco__gt=200&amp;Vaco__lte=300</code></a></li>
    </ul>
  </li>
  <li>field: <code>vintage</code>
    <ul>
    <li>filters: <code>year</code></li>
    <li>example: <a target="_blank" 
href="http://pvfree.alwaysdata.net/api/pvinverter/?format=json&vintage__year=2010"><code>?vintage__year=2010</code></a></li>
    </ul>
  </li>
  </ul>
  <h1>Contributions</h1>
  <p>Contribute to <a target="_blank" 
href="https://github.com/SunPower/pvfree">PV Free on GitHub</a>.</p>
</div>

{% endblock %}

{% block footers %}
<script src="{% static 'highlight/highlight.pack.js' %}"></script>
<script>hljs.initHighlightingOnLoad();</script>
{% endblock footers %}
